---
title: Installation
description: "Install the CostHawk MCP server for Claude Code and Claude Desktop"
---

## Quick Setup

### macOS / Linux

One command to install CostHawk with auto-sync enabled:

```bash
claude mcp add -s user \
  -e COSTHAWK_API_KEY=YOUR_TOKEN_HERE \
  -e COSTHAWK_AUTO_SYNC=true \
  costhawk -- npx --yes costhawk@latest
```

Replace `YOUR_TOKEN_HERE` with your access token from **Settings â†’ Developer** in your CostHawk dashboard.

### Windows

<Warning>
  The `claude mcp add` command has argument parsing issues on Windows. Use the **automated setup** instead.
</Warning>

Run the setup wizard:

```powershell
npx --yes costhawk@latest -- --setup
```

This will:
1. Prompt for your API key
2. Auto-detect your config file location
3. Create or update your MCP configuration
4. Enable auto-sync automatically

**Or manually edit** `%USERPROFILE%\.claude\.mcp.json`:

```json
    {
      "mcpServers": {
        "costhawk": {
          "command": "npx",
          "args": ["--yes", "costhawk@latest"],
          "env": {
            "COSTHAWK_API_KEY": "YOUR_TOKEN_HERE",
            "COSTHAWK_AUTO_SYNC": "true"
          }
        }
  }
}
```

---

## Verify Installation

After setup, verify it worked:

```bash
npx costhawk@latest --self-test
```

You should see `"autoSyncEnabled": true` and `"hasApiKey": true`.

Then restart Claude Code and ask:

> "What CostHawk tools are available?"

---

## Alternative: --setup Command (All Platforms)

If you prefer an interactive setup on any platform:

```bash
npx --yes costhawk@latest -- --setup
```

This works on macOS, Linux, and Windows.

---

## OpenCode (opencode.ai)

OpenCode reads MCP servers from `~/.config/opencode/opencode.json` (or `opencode.jsonc`). Add CostHawk under `mcp`:

```jsonc
{
  "$schema": "https://opencode.ai/config.json",
  "mcp": {
    "costhawk": {
      "type": "local",
      "command": ["npx", "--yes", "costhawk@latest"],
      "enabled": true,
      "environment": {
        "COSTHAWK_API_KEY": "YOUR_TOKEN_HERE"
      }
    }
  }
}
```

If you also use Claude Code or the OpenAI Codex CLI on this machine, you can enable local auto-sync by adding
`"COSTHAWK_AUTO_SYNC": "true"` (and optionally `"COSTHAWK_CODEX_AUTO_SYNC": "false"` to disable Codex sync).

Prefer a guided setup? Run:

```bash
npm exec --yes costhawk@latest -- --setup --opencode --no-claude
```

---

## Claude-Only Mode

If you want to sync Claude Code usage but **not** Codex CLI, add the extra env var:

<Tabs>
  <Tab title="macOS/Linux">
    ```bash
    claude mcp add -s user \
      -e COSTHAWK_API_KEY=YOUR_TOKEN_HERE \
      -e COSTHAWK_AUTO_SYNC=true \
      -e COSTHAWK_CODEX_AUTO_SYNC=false \
      costhawk -- npx --yes costhawk@latest
    ```
  </Tab>
  <Tab title="Windows (manual)">
    ```json
    {
      "mcpServers": {
        "costhawk": {
          "command": "npx",
          "args": ["--yes", "costhawk@latest"],
          "env": {
            "COSTHAWK_API_KEY": "YOUR_TOKEN_HERE",
            "COSTHAWK_AUTO_SYNC": "true",
            "COSTHAWK_CODEX_AUTO_SYNC": "false"
          }
        }
      }
    }
    ```
  </Tab>
</Tabs>

---

## Claude Desktop

### macOS

Edit `~/Library/Application Support/Claude/claude_desktop_config.json`:

```json
{
  "mcpServers": {
    "costhawk": {
      "command": "npx",
      "args": ["--yes", "costhawk@latest"],
      "env": {
        "COSTHAWK_API_KEY": "YOUR_TOKEN_HERE",
        "COSTHAWK_AUTO_SYNC": "true"
      }
    }
  }
}
```

### Windows

Edit `%APPDATA%\Claude\claude_desktop_config.json`:

```json
{
  "mcpServers": {
    "costhawk": {
      "command": "npx",
      "args": ["--yes", "costhawk@latest"],
      "env": {
        "COSTHAWK_API_KEY": "YOUR_TOKEN_HERE",
        "COSTHAWK_AUTO_SYNC": "true"
      }
    }
  }
}
```

Then restart Claude Desktop.

---

## Updating

The MCP server uses `npx costhawk@latest` which automatically fetches the latest version. To force an update, clear the npx cache:

<Tabs>
  <Tab title="macOS/Linux">
    ```bash
    rm -rf ~/.npm/_npx
    ```
  </Tab>
  <Tab title="Windows">
    ```powershell
    Remove-Item -Recurse -Force "$env:LOCALAPPDATA\npm-cache\_npx"
    ```
  </Tab>
</Tabs>

Then restart Claude Code/Desktop.

---

## Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `COSTHAWK_API_KEY` | Yes | - | Your CostHawk access token |
| `COSTHAWK_API_URL` | No | `https://costhawk.ai` | API base URL |
| `COSTHAWK_AUTO_SYNC` | No | `false` | Enable automatic sync on tool calls |
| `COSTHAWK_CODEX_AUTO_SYNC` | No | `true` | Include Codex CLI data in syncs |

---

## Trust & Privacy Features

CostHawk is designed with transparency in mind. Here's how to verify what the MCP server does:

### Preview Mode (Dry Run)

Before syncing any data, you can preview exactly what would be sent:

```
"Sync my Claude Code usage with dryRun enabled"
```

This returns the full payload without making any network requests.

### See What Files We Access

Run this command to see all files CostHawk would read:

```bash
npx costhawk@latest --what-we-read
```

**Output example:**
```
CostHawk MCP Server v1.3.7 - Files We Access

Claude Code:
  ~/.claude/projects/*/conversations.json
  ~/.claude/projects/*/settings.json

OpenAI Codex:
  ~/.codex/sessions/*.json

Note: We only read usage metadata (tokens, models, timestamps).
We never read your code, prompts, or conversation content.
```

### What Data We Send

When you sync, CostHawk sends only:

- **Token counts** - Input/output/cache tokens per session
- **Model identifiers** - Which AI models were used
- **Timestamps** - When sessions occurred
- **Hashed project IDs** - For grouping (never actual project names or paths)
- **Calculated costs** - Based on token counts and current pricing

We **never** send:
- Your code or files
- Prompt content or conversations
- File paths or project names
- Any personally identifiable information
